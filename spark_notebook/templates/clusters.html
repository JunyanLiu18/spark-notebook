{% extends "base.html" %}
{% block body %}

    {% if error %}<p class="error"><strong>Error:</strong> {{ error }}{% endif %}

    <div class="masthead">
    <a href='/'><h3 class="muted">Set up Spark Cluster on AWS</h3></a>
</div>

<hr>

<div class="row-fluid">
    <div class="span12">
        <h1>account: {{data["account_name"]}}</h1>
        <hr>
        <h2>Running Clusters</h2>

        {% if cluster_list %}
        <ul>
          {% for cluster in cluster_list["Clusters"] %}
          <li>
            <a href="/g/{{data['account']}}/{{cluster["Id"]}}">
              {{cluster["Name"]}}
            </a> - {{cluster["Status"]["State"]}}
          </li>
          {% endfor %}
        </ul>
        {% else %}
        <p>No clusters are running.</p>
        {% endif %}

        <hr>

        <form class="form-signin" action="" method="POST">
            <h2 class="form-signin-heading">Create a new cluster</h2>
            <label>Cluster name</label>
            <input id="name" name="name" class="form-control"
                   placeholder="{{"Default: " + data["cluster_name"]}}" autofocus>
            <label>Jupyter Password</label>
            <input id="password" class="form-control" name="password"
                   placeholder="{{"Default: " + data["password"]}}">
            <label>Number of worker nodes (1 master node will also be created)</label>
            <input id="worker_count" class="form-control" name="worker_count"
                   placeholder="{{"Default: " + data["worker_count"]}}">
            <label>Instance type</label>
            <input id="instance_type" class="form-control" name="instance_type"
                   placeholder="{{"Default: " + data["instance_type"]}}">

            <input type="checkbox" name="use_spot" id="use_spot" value="true" checked/>
            <label style="margin-top: 10px;">
                Use spot instances (uncheck for on-demand instances)
            </label>
            <div id="spot-price">
                <label>Maximum price per hour</label>
                <input class="form-control" name="spot_price"
                       placeholder="{{"Default: $" + data["spot_price"]}}">
            </div>
            <button class="btn btn-primary btn-block" type="submit">Create</button>
        </form>
    </div>
</div>
{% endblock %}

{% block js %}
<script>
$(document).ready(function() {
    $('#use_spot').change(function() {
        $('#spot-price').toggle();
    });
});
</script>
{% endblock %}
